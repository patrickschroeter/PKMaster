<div id="applications">
    <div class="rel">
        <h1 class="element element--spacing-bottom-small">Applications</h1>

        <pk-list>
            <pk-list-header>
                <pk-list-attribute (click)="sortBy('state')" [name]="'state-icon'"></pk-list-attribute>
                <pk-list-attribute [name]="'name'">Title</pk-list-attribute>
                <pk-list-attribute (click)="sortBy('created')" [name]="'date'">Created</pk-list-attribute>
                <pk-list-attribute (click)="sortBy('state')" [name]="'state'">Status</pk-list-attribute>
                <pk-list-attribute (click)="sortBy('modified')" [name]="'modified'">Modified</pk-list-attribute>
            </pk-list-header>
            <pk-list-content>
                <pk-list-element *ngFor="let application of applications" [name]="application.state">
                    <pk-list-attribute [name]="'state-icon'" [attr.tooltip]="application.state"></pk-list-attribute>
                    <pk-list-attribute [name]="'name'">
                        <a routerLink="/applications/{{ application.id }}">{{ application.form.title }}</a>
                    </pk-list-attribute>
                    <pk-list-attribute [name]="'date'">{{ application.created | date }}</pk-list-attribute>
                    <pk-list-attribute [name]="'state'">{{ application.state }}</pk-list-attribute>
                    <pk-list-attribute [name]="'modified'">{{ application.modified | date }}</pk-list-attribute>

                    <div class="floating floating--top-right floating--horizontal">
                        <pk-button
                            *ngIf="application.state === 'created'"
                            (onClick)="submitApplication(application)"
                            class="element--rounded element--spacing-left-large" [icon]="'send'" element--success></pk-button>
                        <a
                            *ngIf="['created', 'rescinded'].indexOf(application.state) !== -1"
                            routerLink="/applications/{{ application.id }}/edit">
                            <pk-button class="element--rounded" [icon]="'create'" element--secondary></pk-button>
                        </a>
                        <pk-button
                            *ngIf="['submitted'].indexOf(application.state) !== -1"
                            (onClick)="rescindApplication(application)"
                            class="element--rounded" [icon]="'undo'" element--error></pk-button>
                        <pk-button
                            *ngIf="['created', 'rescinded'].indexOf(application.state) !== -1"
                            (onClick)="deactivateApplication(application)"
                            class="element--rounded" [icon]="'delete'" element--error></pk-button>
                    </div>
                </pk-list-element>
            </pk-list-content>
        </pk-list>

    </div>
    <div class="floating floating--fixed floating--top-right">
        <pk-button class="element--rounded" [icon]="'add'" element--secondary (onClick)="toggleCreateNew()"></pk-button>
    </div>
    <pk-overlay [isOpen]="isOpenNewApplication" (toggleOverlay)="toggleCreateNew()" class="overlay--fluid">
        <div class="pk-overlay__header">Create New Application</div>
        <div class="pk-overlay__content">

            <div class="overlay__option selectable" *ngFor="let option of applicationTypes" (click)="createNewApplication(option)">
                    {{ option.label }}
            </div>
        </div>
    </pk-overlay>
</div>
